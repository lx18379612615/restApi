2023-01-08 19:03:40,395 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:03:40,395 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:04:00,060 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:04:00,060 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:04:00,063 - cluster - INFO - predict start
2023-01-08 19:04:00,064 - cluster - INFO - request params: <bottle.FormsDict object at 0x14e2963d0>
2023-01-08 19:04:00,064 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:04:00,073 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:04:00,402 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:04:00,402 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:04:00,422 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:04:00,422 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:04:00,422 - cluster - INFO - clean data set ...
2023-01-08 19:04:00,550 - restApi - INFO - text_df: 
2023-01-08 19:04:00,550 - restApi - INFO - text_df: 
2023-01-08 19:04:00,550 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:04:00,550 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:04:00,573 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:04:00,573 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:04:00,584 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:04:00,584 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:04:00,592 - cluster - INFO - train data set ...
2023-01-08 19:04:00,594 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:04:00,816 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:06:42,300 - restApi - INFO - app stoped.
2023-01-08 19:06:42,300 - restApi - INFO - app stoped.
2023-01-08 19:06:43,728 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:06:43,728 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:07:10,871 - restApi - INFO - app stoped.
2023-01-08 19:07:10,871 - restApi - INFO - app stoped.
2023-01-08 19:07:12,426 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:07:12,426 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:08:51,136 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:08:51,136 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:08:51,139 - cluster - INFO - predict start
2023-01-08 19:08:51,144 - cluster - INFO - request params: <bottle.FormsDict object at 0x28caf9670>
2023-01-08 19:08:51,144 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:08:51,170 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:08:51,479 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:08:51,479 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:08:51,501 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:08:51,501 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:08:51,501 - cluster - INFO - clean data set ...
2023-01-08 19:08:51,670 - restApi - INFO - text_df: 
2023-01-08 19:08:51,670 - restApi - INFO - text_df: 
2023-01-08 19:08:51,670 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:08:51,670 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:08:51,698 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:08:51,698 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:08:51,720 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:08:51,720 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:08:51,734 - cluster - INFO - train data set ...
2023-01-08 19:08:51,737 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:08:51,982 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:09:42,720 - restApi - INFO - app stoped.
2023-01-08 19:09:42,720 - restApi - INFO - app stoped.
2023-01-08 19:10:09,620 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:10:09,620 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:10:32,683 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:10:32,683 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:11:01,095 - restApi - INFO - app stoped.
2023-01-08 19:11:01,095 - restApi - INFO - app stoped.
2023-01-08 19:19:36,278 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:19:36,278 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:19:43,185 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:19:43,185 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:19:52,755 - cluster - INFO - predict start
2023-01-08 19:19:52,755 - cluster - INFO - request params: <bottle.FormsDict object at 0x16bd85940>
2023-01-08 19:19:58,373 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:19:58,383 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:19:58,774 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:19:58,774 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:19:58,784 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:19:58,785 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:19:58,785 - cluster - INFO - clean data set ...
2023-01-08 19:19:58,935 - restApi - INFO - text_df: 
2023-01-08 19:19:58,935 - restApi - INFO - text_df: 
2023-01-08 19:19:58,935 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:19:58,935 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:19:58,952 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:19:58,952 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:19:58,972 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:19:58,972 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:19:58,987 - cluster - INFO - train data set ...
2023-01-08 19:19:58,991 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:19:59,224 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:20:07,050 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:20:07,050 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:20:07,052 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:20:07,052 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:21:41,036 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:21:41,036 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:21:45,847 - cluster - INFO - predict start
2023-01-08 19:21:45,847 - cluster - INFO - request params: <bottle.FormsDict object at 0x104ca98e0>
2023-01-08 19:21:45,847 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:21:45,857 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:21:46,167 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:21:46,167 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:21:46,175 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:21:46,175 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:21:46,175 - cluster - INFO - clean data set ...
2023-01-08 19:21:46,345 - restApi - INFO - text_df: 
2023-01-08 19:21:46,345 - restApi - INFO - text_df: 
2023-01-08 19:21:46,345 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:21:46,345 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:25:10,812 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:25:10,812 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:27:14,686 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:27:14,686 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:27:14,701 - cluster - INFO - train data set ...
2023-01-08 19:27:14,705 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:27:14,966 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:27:17,737 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:27:17,737 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:27:17,738 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:27:17,738 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:27:27,975 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:27:27,975 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:27:27,978 - cluster - INFO - predict start
2023-01-08 19:27:27,979 - cluster - INFO - request params: <bottle.FormsDict object at 0x16bf90940>
2023-01-08 19:27:27,979 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:27:28,004 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:27:28,322 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:27:28,322 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:27:28,346 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:27:28,346 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:27:28,346 - cluster - INFO - clean data set ...
2023-01-08 19:27:28,528 - restApi - INFO - text_df: 
2023-01-08 19:27:28,528 - restApi - INFO - text_df: 
2023-01-08 19:27:28,529 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:27:28,529 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:27:37,317 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:27:37,317 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:28:03,365 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:28:03,365 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:28:03,380 - cluster - INFO - train data set ...
2023-01-08 19:28:03,384 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:28:03,644 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:28:03,647 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:28:03,647 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:28:03,648 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:28:03,648 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:28:26,518 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:28:26,518 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:28:26,523 - cluster - INFO - predict start
2023-01-08 19:28:26,524 - cluster - INFO - request params: <bottle.FormsDict object at 0x16be74370>
2023-01-08 19:28:26,524 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:28:26,552 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:28:26,843 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:28:26,844 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:28:26,868 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:28:26,868 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:28:26,868 - cluster - INFO - clean data set ...
2023-01-08 19:28:27,032 - restApi - INFO - text_df: 
2023-01-08 19:28:27,032 - restApi - INFO - text_df: 
2023-01-08 19:28:27,033 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:28:27,033 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:28:27,062 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:28:27,062 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:29:02,373 - restApi - INFO - app stoped.
2023-01-08 19:29:02,373 - restApi - INFO - app stoped.
2023-01-08 19:29:03,873 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:29:03,873 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:29:09,960 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:29:09,960 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:29:09,962 - cluster - INFO - predict start
2023-01-08 19:29:09,965 - cluster - INFO - request params: <bottle.FormsDict object at 0x16c469850>
2023-01-08 19:29:09,965 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:29:09,986 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:29:10,798 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:29:10,798 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:29:10,825 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:29:10,825 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:29:10,825 - cluster - INFO - clean data set ...
2023-01-08 19:29:16,560 - restApi - INFO - text_df: 
2023-01-08 19:29:16,560 - restApi - INFO - text_df: 
2023-01-08 19:29:16,560 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:29:16,560 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:29:16,592 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:29:16,592 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:29:16,612 - restApi - INFO - 这是在干嘛1
2023-01-08 19:29:16,612 - restApi - INFO - 这是在干嘛1
2023-01-08 19:29:46,004 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:29:46,004 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:29:46,019 - cluster - INFO - train data set ...
2023-01-08 19:29:46,022 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:29:46,288 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:29:46,301 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:29:46,301 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:29:46,304 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:29:46,304 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:29:58,678 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:29:58,678 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:29:58,681 - cluster - INFO - predict start
2023-01-08 19:29:58,682 - cluster - INFO - request params: <bottle.FormsDict object at 0x17ff51ee0>
2023-01-08 19:29:58,682 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:29:58,719 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:30:18,726 - restApi - ERROR - TransportError(N/A, 'Unable to sniff hosts.')
2023-01-08 19:30:18,726 - restApi - ERROR - TransportError(N/A, 'Unable to sniff hosts.')
2023-01-08 19:30:18,730 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 37, in predict
    full_data = connect_es_scroll(body)
  File "/Users/lengxu/Documents/python/restApi/connect_unit.py", line 92, in connect_es_scroll
    res = scroll_es_data(body, None)
  File "/Users/lengxu/Documents/python/restApi/connect_unit.py", line 109, in scroll_es_data
    es = get_es_connect()
  File "/Users/lengxu/Documents/python/restApi/connect_unit.py", line 137, in get_es_connect
    es = Elasticsearch(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/client/__init__.py", line 207, in __init__
    self.transport = transport_class(_normalize_hosts(hosts), **kwargs)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/transport.py", line 185, in __init__
    self.sniff_hosts(True)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/transport.py", line 327, in sniff_hosts
    node_info = self._get_sniff_data(initial)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/transport.py", line 288, in _get_sniff_data
    raise TransportError("N/A", "Unable to sniff hosts.")
elasticsearch.exceptions.TransportError: TransportError(N/A, 'Unable to sniff hosts.')

2023-01-08 19:30:18,730 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 37, in predict
    full_data = connect_es_scroll(body)
  File "/Users/lengxu/Documents/python/restApi/connect_unit.py", line 92, in connect_es_scroll
    res = scroll_es_data(body, None)
  File "/Users/lengxu/Documents/python/restApi/connect_unit.py", line 109, in scroll_es_data
    es = get_es_connect()
  File "/Users/lengxu/Documents/python/restApi/connect_unit.py", line 137, in get_es_connect
    es = Elasticsearch(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/client/__init__.py", line 207, in __init__
    self.transport = transport_class(_normalize_hosts(hosts), **kwargs)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/transport.py", line 185, in __init__
    self.sniff_hosts(True)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/transport.py", line 327, in sniff_hosts
    node_info = self._get_sniff_data(initial)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/elasticsearch/transport.py", line 288, in _get_sniff_data
    raise TransportError("N/A", "Unable to sniff hosts.")
elasticsearch.exceptions.TransportError: TransportError(N/A, 'Unable to sniff hosts.')

2023-01-08 19:30:34,985 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:30:34,985 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:30:34,990 - cluster - INFO - predict start
2023-01-08 19:30:34,991 - cluster - INFO - request params: <bottle.FormsDict object at 0x17eefb1c0>
2023-01-08 19:30:34,992 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:30:35,022 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:30:35,366 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:30:35,366 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:30:35,375 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:30:35,375 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:30:35,375 - cluster - INFO - clean data set ...
2023-01-08 19:30:35,556 - restApi - INFO - text_df: 
2023-01-08 19:30:35,556 - restApi - INFO - text_df: 
2023-01-08 19:30:35,556 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:30:35,556 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:30:35,572 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:30:35,572 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:30:35,593 - restApi - INFO - 这是在干嘛1
2023-01-08 19:30:35,593 - restApi - INFO - 这是在干嘛1
2023-01-08 19:30:52,962 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:30:52,962 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:30:52,977 - cluster - INFO - train data set ...
2023-01-08 19:30:52,980 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:30:53,224 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:31:01,591 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:31:01,591 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:31:01,591 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:31:01,591 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:31:13,461 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:31:13,461 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:31:13,463 - cluster - INFO - predict start
2023-01-08 19:31:13,463 - cluster - INFO - request params: <bottle.FormsDict object at 0x17ff51be0>
2023-01-08 19:31:13,463 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:31:13,473 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:31:13,768 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:31:13,769 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:31:13,777 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:31:13,777 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:31:13,777 - cluster - INFO - clean data set ...
2023-01-08 19:31:13,938 - restApi - INFO - text_df: 
2023-01-08 19:31:13,938 - restApi - INFO - text_df: 
2023-01-08 19:31:13,938 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:31:13,938 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:31:13,956 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:31:13,956 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:31:13,974 - restApi - INFO - 这是在干嘛1
2023-01-08 19:31:13,974 - restApi - INFO - 这是在干嘛1
2023-01-08 19:31:13,977 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:31:13,977 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:31:13,991 - cluster - INFO - train data set ...
2023-01-08 19:31:13,994 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:31:14,309 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:31:14,312 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:31:14,312 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:31:14,312 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:31:14,312 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:33:57,630 - restApi - INFO - app stoped.
2023-01-08 19:33:57,630 - restApi - INFO - app stoped.
2023-01-08 19:34:04,785 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:34:04,785 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:34:18,735 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:34:18,735 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:34:18,736 - cluster - INFO - predict start
2023-01-08 19:34:18,738 - cluster - INFO - request params: <bottle.FormsDict object at 0x15f5d31c0>
2023-01-08 19:34:18,739 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:34:18,761 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:34:19,042 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:34:19,043 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:34:19,066 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:34:19,066 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:34:19,066 - cluster - INFO - clean data set ...
2023-01-08 19:34:19,248 - restApi - INFO - text_df: 
2023-01-08 19:34:19,248 - restApi - INFO - text_df: 
2023-01-08 19:34:19,248 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:34:19,248 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:34:19,282 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:34:19,282 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:34:19,303 - restApi - INFO - 这是在干嘛12
2023-01-08 19:34:19,303 - restApi - INFO - 这是在干嘛12
2023-01-08 19:34:19,306 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:34:19,306 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:34:19,321 - cluster - INFO - train data set ...
2023-01-08 19:34:19,325 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:34:19,588 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:34:19,601 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:34:19,601 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:34:19,604 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:34:19,604 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:35:00,166 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:35:00,166 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:35:00,167 - cluster - INFO - predict start
2023-01-08 19:35:00,168 - cluster - INFO - request params: <bottle.FormsDict object at 0x15f5d3460>
2023-01-08 19:35:00,168 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:35:00,178 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:35:00,529 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:35:00,529 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:35:00,537 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:35:00,537 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:35:00,537 - cluster - INFO - clean data set ...
2023-01-08 19:35:00,688 - restApi - INFO - text_df: 
2023-01-08 19:35:00,688 - restApi - INFO - text_df: 
2023-01-08 19:35:00,689 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:35:00,689 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:35:00,715 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:35:00,715 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:35:00,734 - restApi - INFO - 这是在干嘛12
2023-01-08 19:35:00,734 - restApi - INFO - 这是在干嘛12
2023-01-08 19:35:00,737 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:35:00,737 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:35:00,751 - cluster - INFO - train data set ...
2023-01-08 19:35:00,755 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:35:01,008 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:35:01,011 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:35:01,011 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:35:01,012 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:35:01,012 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:36:56,262 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:36:56,262 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:36:56,265 - cluster - INFO - predict start
2023-01-08 19:36:56,266 - cluster - INFO - request params: <bottle.FormsDict object at 0x15f634070>
2023-01-08 19:36:56,267 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:36:56,302 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:36:56,623 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:36:56,623 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:36:56,631 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:36:56,631 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:36:56,631 - cluster - INFO - clean data set ...
2023-01-08 19:36:56,840 - restApi - INFO - text_df: 
2023-01-08 19:36:56,840 - restApi - INFO - text_df: 
2023-01-08 19:36:56,840 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:36:56,840 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:36:56,856 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:36:56,856 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:36:56,876 - restApi - INFO - 这是在干嘛12
2023-01-08 19:36:56,876 - restApi - INFO - 这是在干嘛12
2023-01-08 19:36:56,879 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:36:56,879 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:36:56,893 - cluster - INFO - train data set ...
2023-01-08 19:36:56,897 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:36:57,190 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:36:57,193 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:36:57,193 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:36:57,194 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:36:57,194 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:37:20,812 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:37:20,812 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:37:20,814 - cluster - INFO - predict start
2023-01-08 19:37:20,815 - cluster - INFO - request params: <bottle.FormsDict object at 0x15f634190>
2023-01-08 19:37:20,816 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:37:20,833 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:37:21,124 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:37:21,124 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:37:21,149 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:37:21,149 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:37:21,149 - cluster - INFO - clean data set ...
2023-01-08 19:37:21,294 - restApi - INFO - text_df: 
2023-01-08 19:37:21,294 - restApi - INFO - text_df: 
2023-01-08 19:37:21,295 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:37:21,295 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:37:21,324 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:37:21,324 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:37:21,342 - restApi - INFO - 这是在干嘛12
2023-01-08 19:37:21,342 - restApi - INFO - 这是在干嘛12
2023-01-08 19:37:21,345 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:37:21,345 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:37:21,358 - cluster - INFO - train data set ...
2023-01-08 19:37:21,361 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:37:21,658 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:37:21,661 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:37:21,661 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:37:21,662 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:37:21,662 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:38:27,837 - restApi - INFO - app stoped.
2023-01-08 19:38:27,837 - restApi - INFO - app stoped.
2023-01-08 19:40:07,349 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:40:07,349 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:41:55,725 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:41:55,725 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:44:27,175 - restApi - INFO - app stoped.
2023-01-08 19:44:27,175 - restApi - INFO - app stoped.
2023-01-08 19:44:28,607 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:44:28,607 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:44:36,821 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:44:36,821 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:44:42,716 - cluster - INFO - predict start
2023-01-08 19:44:42,717 - cluster - INFO - request params: <bottle.FormsDict object at 0x177308fa0>
2023-01-08 19:44:42,717 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:44:42,727 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:45:08,502 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:45:08,503 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:45:08,514 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:45:08,514 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:45:08,514 - cluster - INFO - clean data set ...
2023-01-08 19:45:10,792 - restApi - INFO - text_df: 
2023-01-08 19:45:10,792 - restApi - INFO - text_df: 
2023-01-08 19:45:10,793 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:45:10,793 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:45:10,811 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:45:10,811 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:45:10,830 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:45:10,830 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:45:10,833 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:45:10,833 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:45:10,847 - cluster - INFO - train data set ...
2023-01-08 19:45:10,850 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:45:11,098 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:45:11,111 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:45:11,111 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:45:11,114 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:45:11,114 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:45:36,406 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:45:36,406 - restApi - INFO - calling cluster.predict() ...
2023-01-08 19:45:42,887 - cluster - INFO - predict start
2023-01-08 19:45:42,888 - cluster - INFO - request params: <bottle.FormsDict object at 0x1046b26d0>
2023-01-08 19:45:42,888 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:45:42,898 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:45:43,191 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:45:43,192 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:45:43,202 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:45:43,203 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:45:43,203 - cluster - INFO - clean data set ...
2023-01-08 19:45:43,342 - restApi - INFO - text_df: 
2023-01-08 19:45:43,342 - restApi - INFO - text_df: 
2023-01-08 19:45:43,342 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:45:43,342 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:45:43,357 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:45:43,357 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:45:43,378 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:45:43,378 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:46:11,118 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:46:11,118 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:46:42,777 - cluster - INFO - train data set ...
2023-01-08 19:47:32,580 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:54:58,535 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:54:58,538 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:54:58,538 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:54:58,539 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:54:58,539 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:54:59,356 - restApi - INFO - app stoped.
2023-01-08 19:54:59,356 - restApi - INFO - app stoped.
2023-01-08 19:55:00,873 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:55:00,873 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:55:10,408 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 19:55:10,408 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 19:55:15,024 - cluster - INFO - predict start
2023-01-08 19:55:15,025 - cluster - INFO - request params: <bottle.FormsDict object at 0x28c9f6610>
2023-01-08 19:55:15,025 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:55:15,037 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:55:15,331 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:55:15,331 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:55:15,340 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:55:15,340 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:55:15,340 - cluster - INFO - clean data set ...
2023-01-08 19:55:15,509 - restApi - INFO - text_df: 
2023-01-08 19:55:15,509 - restApi - INFO - text_df: 
2023-01-08 19:55:15,509 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:55:15,509 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:55:15,527 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:55:15,527 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:55:15,546 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:55:15,546 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:55:21,033 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:55:21,033 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:55:21,048 - cluster - INFO - train data set ...
2023-01-08 19:55:21,052 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:55:49,059 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:55:49,071 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:55:49,071 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:55:49,072 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:55:49,072 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:56:11,629 - restApi - INFO - app stoped.
2023-01-08 19:56:11,629 - restApi - INFO - app stoped.
2023-01-08 19:56:13,104 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:56:13,104 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 19:56:19,803 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 19:56:19,803 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 19:56:19,806 - cluster - INFO - predict start
2023-01-08 19:56:19,807 - cluster - INFO - request params: <bottle.FormsDict object at 0x1083f34c0>
2023-01-08 19:56:19,807 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 19:56:19,817 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 19:56:20,134 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 19:56:20,134 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:56:20,159 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 19:56:20,159 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 19:56:20,159 - cluster - INFO - clean data set ...
2023-01-08 19:56:20,309 - restApi - INFO - text_df: 
2023-01-08 19:56:20,309 - restApi - INFO - text_df: 
2023-01-08 19:56:20,309 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:56:20,309 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 19:56:20,338 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:56:20,338 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 19:56:20,358 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:56:20,358 - restApi - INFO - 这是在干嘛1235
2023-01-08 19:56:20,360 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:56:20,360 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:56:20,375 - cluster - INFO - train data set ...
2023-01-08 19:56:20,380 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 19:59:55,506 - cluster - INFO - train ok, predict itself ...
2023-01-08 19:59:55,519 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:59:55,519 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 19:59:55,520 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 19:59:55,520 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:00:13,432 - restApi - INFO - app stoped.
2023-01-08 20:00:13,432 - restApi - INFO - app stoped.
2023-01-08 20:00:14,927 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:00:14,927 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:00:25,637 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:00:25,637 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:00:25,656 - cluster - INFO - predict start
2023-01-08 20:00:25,657 - cluster - INFO - request params: <bottle.FormsDict object at 0x13ca2e520>
2023-01-08 20:00:25,657 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 20:00:25,667 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 20:00:51,755 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 20:00:51,755 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:00:51,766 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 20:00:51,767 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 20:00:51,767 - cluster - INFO - clean data set ...
2023-01-08 20:00:51,991 - restApi - INFO - text_df: 
2023-01-08 20:00:51,991 - restApi - INFO - text_df: 
2023-01-08 20:00:51,991 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:00:51,991 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:00:52,008 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:00:52,008 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:00:52,027 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:00:52,027 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:00:52,029 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:00:52,029 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:00:52,043 - cluster - INFO - train data set ...
2023-01-08 20:00:52,047 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:00:52,047 - cluster - INFO - k: 2
2023-01-08 20:00:52,068 - cluster - INFO - k: 3
2023-01-08 20:00:52,086 - cluster - INFO - k: 4
2023-01-08 20:00:52,109 - cluster - INFO - k: 5
2023-01-08 20:00:52,132 - cluster - INFO - k: 6
2023-01-08 20:00:52,156 - cluster - INFO - k: 7
2023-01-08 20:00:52,179 - cluster - INFO - k: 8
2023-01-08 20:00:52,203 - cluster - INFO - k: 9
2023-01-08 20:00:52,230 - cluster - INFO - k: 10
2023-01-08 20:00:52,258 - cluster - INFO - k: 11
2023-01-08 20:00:52,294 - cluster - INFO - train ok, predict itself ...
2023-01-08 20:00:52,307 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 20:00:52,307 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 20:00:52,308 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:00:52,308 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:01:45,832 - restApi - INFO - app stoped.
2023-01-08 20:01:45,832 - restApi - INFO - app stoped.
2023-01-08 20:01:47,289 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:01:47,289 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:01:53,590 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:01:53,590 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:01:53,594 - cluster - INFO - predict start
2023-01-08 20:01:53,597 - cluster - INFO - request params: <bottle.FormsDict object at 0x157400460>
2023-01-08 20:01:53,597 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 20:01:53,617 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 20:01:53,993 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 20:01:53,993 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:01:54,015 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 20:01:54,015 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 20:01:54,016 - cluster - INFO - clean data set ...
2023-01-08 20:01:54,188 - restApi - INFO - text_df: 
2023-01-08 20:01:54,188 - restApi - INFO - text_df: 
2023-01-08 20:01:54,189 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:01:54,189 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:01:54,230 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:01:54,230 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:01:54,250 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:01:54,250 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:01:54,253 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:01:54,253 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:01:54,268 - cluster - INFO - train data set ...
2023-01-08 20:01:54,272 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:01:54,272 - cluster - INFO - k: 2
2023-01-08 20:01:54,294 - cluster - INFO - k: 3
2023-01-08 20:01:54,319 - cluster - INFO - k: 4
2023-01-08 20:01:54,337 - cluster - INFO - k: 5
2023-01-08 20:01:54,363 - cluster - INFO - k: 6
2023-01-08 20:01:54,386 - cluster - INFO - k: 7
2023-01-08 20:01:54,411 - cluster - INFO - k: 8
2023-01-08 20:01:54,438 - cluster - INFO - k: 9
2023-01-08 20:01:54,469 - cluster - INFO - train ok, predict itself ...
2023-01-08 20:01:54,482 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 20:01:54,482 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 20:01:54,483 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:01:54,483 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:03:58,548 - restApi - INFO - app stoped.
2023-01-08 20:03:58,548 - restApi - INFO - app stoped.
2023-01-08 20:04:00,026 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:04:00,026 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:04:05,740 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:04:05,740 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:04:05,743 - cluster - INFO - predict start
2023-01-08 20:04:05,745 - cluster - INFO - request params: <bottle.FormsDict object at 0x16dab18e0>
2023-01-08 20:04:05,746 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 20:04:05,764 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 20:04:06,119 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 20:04:06,119 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:04:06,147 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 20:04:06,147 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 20:04:06,147 - cluster - INFO - clean data set ...
2023-01-08 20:04:06,288 - restApi - INFO - text_df: 
2023-01-08 20:04:06,288 - restApi - INFO - text_df: 
2023-01-08 20:04:06,288 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:04:06,288 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:04:06,315 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:04:06,315 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:04:06,333 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:04:06,333 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:04:06,336 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:04:06,336 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:04:06,349 - cluster - INFO - train data set ...
2023-01-08 20:04:06,354 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:04:29,165 - cluster - INFO - k: 2
2023-01-08 20:04:30,933 - cluster - INFO - k: 3
2023-01-08 20:04:32,185 - cluster - INFO - k: 4
2023-01-08 20:06:41,112 - cluster - INFO - train ok, predict itself ...
2023-01-08 20:06:41,125 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 20:06:41,125 - restApi - ERROR - 'NoneType' object has no attribute 'split'
2023-01-08 20:06:41,126 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:06:41,126 - restApi - ERROR - Traceback (most recent call last):
  File "/Users/lengxu/Documents/python/restApi/restApi.py", line 38, in predict
    return cluster.predict()
  File "/Users/lengxu/Documents/python/restApi/cluster.py", line 67, in predict
    pred = clf.predict(data)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1061, in predict
    labels = _labels_inertia_threadpool_limit(
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 812, in _labels_inertia_threadpool_limit
    with threadpool_limits(limits=1, user_api="blas"):
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 151, in threadpool_limits
    return threadpoolctl.threadpool_limits(limits=limits, user_api=user_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 171, in __init__
    self._original_info = self._set_threadpool_limits()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 268, in _set_threadpool_limits
    modules = _ThreadpoolInfo(prefixes=self._prefixes,
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 340, in __init__
    self._load_modules()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 371, in _load_modules
    self._find_modules_with_dyld()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 428, in _find_modules_with_dyld
    self._make_module_from_path(filepath)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 515, in _make_module_from_path
    module = module_class(filepath, prefix, user_api, internal_api)
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 606, in __init__
    self.version = self.get_version()
  File "/Users/lengxu/Documents/python/projects/restApi/lib/python3.9/site-packages/threadpoolctl.py", line 646, in get_version
    config = get_config().split()
AttributeError: 'NoneType' object has no attribute 'split'

2023-01-08 20:06:56,506 - restApi - INFO - app stoped.
2023-01-08 20:06:56,506 - restApi - INFO - app stoped.
2023-01-08 20:06:57,966 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:06:57,966 - restApi - INFO - starting app with config {"master_name": "mymaster", "redis_host": "10.20.35.85", "redis_port": "6379", "redis_password": "dmpIwin@123", "es_https_status": 0, "es_sniff_on_start": true, "es_user": "elastic", "es_password": "hundsun@123", "es_hosts": ["10.20.32.118:9400"], "es_timeout": 36000, "es_index": "group_tag_all_gy", "page_size": 5000, "n_components": 10, "service_host": "localhost", "service_port": 8087, "log_file": "./ml.log", "key_field_name": "fund_account"}...
2023-01-08 20:07:22,585 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:07:22,585 - restApi - INFO - calling cluster.predict()111 ...
2023-01-08 20:07:22,588 - cluster - INFO - predict start
2023-01-08 20:07:22,590 - cluster - INFO - request params: <bottle.FormsDict object at 0x15faec940>
2023-01-08 20:07:22,591 - cluster - INFO - params: dict_values([{'columns': ['[{"c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"é\x9d\x92å¹´","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadå¹´","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"ä¸\xadè\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"è\x80\x81å¹´","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"å®¢æ\x88·å¹´é¾\x84æ®µ","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}]'], 'group_id': ['4536'], 'sql_str': ['{"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}}']}])
2023-01-08 20:07:22,614 - cluster - INFO - convert english columns[{"c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","dicts":[{"c_dict_entry":"1000000001","c_dict_prompt":"青年","c_dict_type":"0","c_sub_entry":"0","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中年","c_dict_type":"0","c_sub_entry":"1","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"中老年","c_dict_type":"0","c_sub_entry":"2","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"},{"c_dict_entry":"1000000001","c_dict_prompt":"老年","c_dict_type":"0","c_sub_entry":"3","c_tag_category_id":"10010310601180000002","c_tag_category_name":"客户年龄段","c_tag_english_name":"age_group","c_tag_unit":"/"}],"tag_status":0}] => chinese columns{'age_group': '客户年龄段'}
2023-01-08 20:07:22,936 - cluster - INFO - get es data {"query":{"bool":{"should":[{"bool":{"must":[{"regexp":{"mobile_tel.keyword":{"value":".*13.*","flags_value":65535,"max_determinized_states":10000,"boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["age_group"],"excludes":[]}} => 57 records
2023-01-08 20:07:22,937 - cluster - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:07:22,963 - cluster - INFO - convert english columns Index(['age_group'], dtype='object')
2023-01-08 20:07:22,964 - cluster - INFO - to chinese columns ['客户年龄段']
2023-01-08 20:07:22,964 - cluster - INFO - clean data set ...
2023-01-08 20:07:23,154 - restApi - INFO - text_df: 
2023-01-08 20:07:23,154 - restApi - INFO - text_df: 
2023-01-08 20:07:23,154 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:07:23,154 - restApi - INFO -    age_group
0          0
1          2
2          0
3          2
4          3
5          2
6          2
7          0
8          2
9          0
10         0
11         2
12         2
13         2
14         2
15         1
16         3
17         2
18         2
19         0
20         2
21         2
22         0
23         2
24         0
25         2
26         2
27         3
28         1
29         0
30         1
31         2
32         2
33         1
34         0
35         3
36         2
37         0
38         2
39         0
40         1
41         2
42         3
43         1
44         1
45         3
46         0
47         0
48         1
49         1
50         3
51         1
52         3
53         1
54         1
55         0
56         2
2023-01-08 20:07:23,171 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:07:23,171 - restApi - INFO -     age_group
0         0.0
1         2.0
2         0.0
3         2.0
4         3.0
5         2.0
6         2.0
7         0.0
8         2.0
9         0.0
10        0.0
11        2.0
12        2.0
13        2.0
14        2.0
15        1.0
16        3.0
17        2.0
18        2.0
19        0.0
20        2.0
21        2.0
22        0.0
23        2.0
24        0.0
25        2.0
26        2.0
27        3.0
28        1.0
29        0.0
30        1.0
31        2.0
32        2.0
33        1.0
34        0.0
35        3.0
36        2.0
37        0.0
38        2.0
39        0.0
40        1.0
41        2.0
42        3.0
43        1.0
44        1.0
45        3.0
46        0.0
47        0.0
48        1.0
49        1.0
50        3.0
51        1.0
52        3.0
53        1.0
54        1.0
55        0.0
56        2.0
2023-01-08 20:07:23,191 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:07:23,191 - restApi - INFO - 这是在干嘛1235
2023-01-08 20:07:23,193 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:07:23,193 - restApi - INFO -     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
2023-01-08 20:07:23,208 - cluster - INFO - train data set ...
2023-01-08 20:07:23,211 - cluster - INFO - data:     age_group
0   -1.371182
1    0.582752
2   -1.371182
3    0.582752
4    1.559720
5    0.582752
6    0.582752
7   -1.371182
8    0.582752
9   -1.371182
10  -1.371182
11   0.582752
12   0.582752
13   0.582752
14   0.582752
15  -0.394215
16   1.559720
17   0.582752
18   0.582752
19  -1.371182
20   0.582752
21   0.582752
22  -1.371182
23   0.582752
24  -1.371182
25   0.582752
26   0.582752
27   1.559720
28  -0.394215
29  -1.371182
30  -0.394215
31   0.582752
32   0.582752
33  -0.394215
34  -1.371182
35   1.559720
36   0.582752
37  -1.371182
38   0.582752
39  -1.371182
40  -0.394215
41   0.582752
42   1.559720
43  -0.394215
44  -0.394215
45   1.559720
46  -1.371182
47  -1.371182
48  -0.394215
49  -0.394215
50   1.559720
51  -0.394215
52   1.559720
53  -0.394215
54  -0.394215
55  -1.371182
56   0.582752
